# カヴィヴァラ応援課金機能の要件定義書

## 概要

ユーザーがカヴィヴァラさんたちを「応援する」という体で、金銭的なサポートを行える機能を提供する。アプリの基本機能は無料のまま維持し、純粋な応援としての課金を実現する。

## 背景

現在、アプリは完全無料で提供されているが、継続的な開発・運営コスト（サーバー費用、AI API 費用など）をサポートする仕組みが必要である。機能制限による課金ではなく、「応援」という形での課金により、ユーザーとの良好な関係を維持しつつ収益化を図る。

## ユーザーストーリー

### 応援の気持ちを金銭的に表現したい

ユーザーとして、カヴィヴァラさんたちへの感謝や応援の気持ちを金銭的なサポートとして表現したい。なぜならば、良いサービスを提供してくれる開発者を支援することで、継続的な運営を後押しできるからだ。

受入基準:

- 3 つの金額プランから選択できる（¥120, ¥370, ¥610）
- 各金額に応じた応援メッセージが表示される
- 課金は都度課金（消費型）として実装される
- 全てのユーザーが応援可能（アプリの基本機能は無料のまま）

### ヴィヴァポイントを貯めて称号を獲得したい

ユーザーとして、応援するとヴィヴァポイントが貯まり、累計ポイントに応じた称号を獲得したい。なぜならば、自分の貢献度がポイントと称号として可視化されることで、参加意識や達成感が高まるからだ。

受入基準:

- 応援課金をするとヴィヴァポイントが付与される
- 金額が多いプランほど、比例以上にお得なポイントが獲得できる
- 累計ヴィヴァポイントに応じて称号が付与される
- 設定画面に現在の称号が表示される
- 応援画面に累計ヴィヴァポイントと現在の称号、次の称号までの進捗が表示される
- ヴィヴァポイントと称号データはローカル（SharedPreferences）に保存される
- 個別の応援履歴（日時・金額の詳細）は記録しない

### 応援後に感謝を受け取りたい

ユーザーとして、応援した後にカヴィヴァラからの感謝メッセージを受け取りたい。なぜならば、応援が届いたことを実感でき、満足感が得られるからだ。

受入基準:

- 応援完了時に感謝のダイアログが表示される
- 「応援ありがとうヴィヴァ！」などのカヴィヴァラらしいメッセージ

### 課金しても機能が変わらないことを理解したい

ユーザーとして、応援課金が純粋なサポートであり、機能追加がないことを明確に理解したい。なぜならば、誤解なく納得した上で応援したいからだ。

受入基準:

- 応援画面に「応援課金では機能は追加されません」ことが明記される
- 「アプリの基本機能は引き続き無料でご利用いただけます」という説明
- 透明性のある説明で、ユーザーが安心して応援できる

## UI 仕様

### 設定画面からのアクセス

```
┌─────────────────────────────────────┐
│ 設定                            ← │
├─────────────────────────────────────┤
│ アカウント                          │
├─────────────────────────────────────┤
│ ...                                 │
├─────────────────────────────────────┤
│ アプリについて                      │
├─────────────────────────────────────┤
│ 💝  カヴィヴァラを応援              │
│     5VP・称号: 応援サポーター  →   │
├─────────────────────────────────────┤
│ ...                                 │
└─────────────────────────────────────┘
```

- アイコン: 💝
- タイトル: "カヴィヴァラを応援"
- サブタイトル: 累計ヴィヴァポイントと現在の称号（未応援時は表示なし）
  - 表示例: "5VP・称号: 応援サポーター"

### 応援画面のレイアウト

応援画面には以下を表示:

- カヴィヴァラのアイコンと説明文
- 応援金の使い道（サーバー運営費、新機能開発など）
- 累計ヴィヴァポイントと現在の称号
- 次の称号までの進捗（例: 「次の称号まであと 5VP」）
- 3 つの応援プラン（各プランの獲得ポイントを表示）
- 注意書き（機能追加なし、基本機能は無料であることを明示）

### 応援プラン

| プラン名     | 金額 | 獲得 VP | メッセージ                       |
| ------------ | ---- | ------- | -------------------------------- |
| ちょっと応援 | ¥120 | 1VP     | 「頑張って！」                   |
| しっかり応援 | ¥370 | 4VP     | 「いつもありがとう！」           |
| めっちゃ応援 | ¥610 | 8VP     | 「これからも応援するヴィヴァ！」 |

※金額は日本円の例。各国の通貨に応じた価格設定が必要。
※VP（ヴィヴァポイント）は金額が多いほど比例以上にお得に設定。

### ヴィヴァポイントと応援称号

累計ヴィヴァポイント（VP）に応じて称号が付与される:

| 累計 VP | 称号                 |
| ------- | -------------------- |
| 1VP     | 応援ビギナー         |
| 5VP     | 応援サポーター       |
| 10VP    | 応援エキスパート     |
| 20VP    | 応援マスター         |
| 50VP    | 応援レジェンド       |
| 100VP   | 応援グランドマスター |

※称号名は仮称。カヴィヴァラらしい表現に変更可能。

## 制約事項

- 応援課金では機能は追加されない（純粋なサポート）
- アプリの基本機能は全て無料のまま提供
- App Store / Google Play のガイドライン準拠
  - 「寄付」「投げ銭」ではなく「応援」という表現を使用
  - 課金なしでも全機能が利用可能であることを明示
  - 機能追加がないことを明確に説明

## 関連ドキュメント

- [技術設計書: カヴィヴァラ応援課金機能](../design/support-cavivara-donation.md)（作成予定）
- [in_app_purchase plugin documentation](https://pub.dev/packages/in_app_purchase)
